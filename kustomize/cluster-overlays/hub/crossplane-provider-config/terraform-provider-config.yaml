apiVersion: tf.upbound.io/v1beta1
kind: ProviderConfig
metadata:
  name: default
spec:
  # Note that unlike most provider configs this one supports an array of
  # credentials. This is because each Terraform workspace uses a single
  # Crossplane provider config, but could use multiple Terraform providers each
  # with their own credentials.
  credentials:
    - filename: azure-credentials.json
      source: Secret
      secretRef:
        namespace: crossplane-system
        name: azure-secret
        key: creds
    - filename: aws-credentials.json
      source: Secret
      secretRef:
        namespace: crossplane-system
        name: aws-secret
        key: creds
  configuration: |
    terraform {
      backend "kubernetes" {
        secret_suffix    = "state"
        in_cluster_config = true
        namespace = "crossplane-system"
      }  
    }

    provider "azurerm" {
      features {}
      client_id = var.clientId
      client_secret = var.clientSecret
      subscription_id = var.subscriptionId
      tenant_id = var.tenantId
      use_cli = false
    }

    provider "azapi" {
      client_id = var.clientId
      client_secret = var.clientSecret
      subscription_id = var.subscriptionId
      tenant_id = var.tenantId
      use_cli = false
    }              

        